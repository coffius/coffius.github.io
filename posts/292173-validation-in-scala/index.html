<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-EN" lang="en-EN">
<head>
    










    







<script defer language="javascript" type="text/javascript" src="/js/bundle.min.a43a549406127e0715f68083c987d71d0c71054cd57edea77aa709ed9958af6e.js"></script>






    
    <meta http-equiv="content-type" content="text/html; charset=utf-8">

    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    
    <link rel="icon" href=/favicon.png>

    
    





  





  
  
  


<!-- Open Graph image and Twitter Card metadata -->

<title itemprop="name">Koff.io - Validation in scala</title>
<meta property="og:title" content=Koff.io&#32;-&#32;Validation&#32;in&#32;scala />
<meta name="twitter:title" content=Koff.io&#32;-&#32;Validation&#32;in&#32;scala />
<meta itemprop="name" content=Koff.io&#32;-&#32;Validation&#32;in&#32;scala />
<meta name="application-name" content=Koff.io&#32;-&#32;Validation&#32;in&#32;scala />
<meta property="og:site_name" content="KOFF.io" />


<meta name="description" content="" />
<meta itemprop="description" content="" />
<meta property="og:description" content="" />
<meta name="twitter:description" content="" />


<base href="http://coffius.github.io/posts/292173-validation-in-scala/" />
<link rel="canonical" href="http://coffius.github.io/posts/292173-validation-in-scala/" itemprop="url" />
<meta name="url" content="http://coffius.github.io/posts/292173-validation-in-scala/" />
<meta name="twitter:url" content="http://coffius.github.io/posts/292173-validation-in-scala/" />
<meta property="og:url" content="http://coffius.github.io/posts/292173-validation-in-scala/" />


<meta property="og:updated_time" content=27011-27-12T1111:00:15&#43;0300 />


<link rel="sitemap" type="application/xml" title="Sitemap" href='http://coffius.github.io/sitemap.xml' />

<meta name="robots" content="index,follow" />
<meta name="googlebot" content="index,follow" />


<meta name="twitter:site" content="https://twitter.com/coffius" />
<meta name="twitter:creator" content="https://twitter.com/coffius" />
<meta property="fb:admins" content="" />


<meta name="apple-mobile-web-app-title" content="KOFF.io" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black" />








<meta property="og:type" content="article" />
<meta property="article:publisher" content="" />
<meta property="og:article:published_time" content=27011-27-12T1111:00:15&#43;0300 />
<meta property="article:published_time" content=27011-27-12T1111:00:15&#43;0300 />








<meta name="generator" content="Hugo 0.119.0">


    
    

<link type="text/css" rel="stylesheet" href="/css/bundle.min.8c227569d4bf422323072472267fbadf39d2c717cb88332a8413d08b0b2b17e8.css">


    
    <style>
    body {
        --sidebar-bg-color: #202020;
        --sidebar-img-border-color: #515151;
        --sidebar-p-color: #909090;
        --sidebar-h1-color: #FFF;
        --sidebar-a-color: #FFF;
        --sidebar-socials-color: #FFF;
        --text-color: #222;
        --bkg-color: #FAF9F6;
        --post-title-color: #303030;
        --list-color: #5a5a5a;
        --link-color: #268bd2;
        --date-color: #515151;
        --table-border-color: #E5E5E5;
        --table-stripe-color: #F9F9F9;
        --code-color: #000;
        --code-background-color: #E5E5E5;
        --code-block-color: #fff;
        --code-block-background-color: #272822;
        --moon-sun-color: #FFF;
        --moon-sun-background-color: #515151;
    }
    body.dark-theme {
        --text-color: #eee;
        --bkg-color: #121212;
        --post-title-color: #DBE2E9;
        --list-color: #9d9d9d;
        --link-color: #268bd2;
        --date-color: #9a9a9a;
        --table-border-color: #515151;
        --table-stripe-color: #202020;
        --code-color: #fff;
        --code-background-color: #515151;
        --code-block-color: #fff;
        --code-block-background-color: #272822;
    }
    body {
        background-color: var(--bkg-color);
    }
</style>

</head>

    <body class="dark-theme">
        <div class="wrapper">
            <aside class="sidebar">
    <div class="container sidebar-sticky">
        <div class="light-dark" align="right">
    <button class="btn-light-dark" title="Toggle light/dark mode">
        <svg class="moon" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16">
            <path fill="currentColor" d="M6 .278a.768.768 0 0 1 .08.858a7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277c.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316a.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71C0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"/>
        </svg>
        <svg class="sun" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16">
            <path fill="currentColor" d="M8 12a4 4 0 1 0 0-8a4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"/>
        </svg>
    </button>
</div>

        <div class="sidebar-about">
    <h1 class="brand">
        
        
            <a href="http://coffius.github.io/">
                <h1>KOFF.io</h1>
            </a>
        
    </h1>
    <p class="lead">
    where scala is beloved
    </p>
</div>

        <nav>
    <ul class="sidebar-nav">

        
        
        

    </ul>
</nav>

        
    <a target="_blank" class="social" title="GitHub" href="https://github.com/coffius">
        <svg xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" viewBox="-2 -2 24 24">
            <path fill="currentColor" d="M18.88 1.099C18.147.366 17.265 0 16.233 0H3.746C2.714 0 1.832.366 1.099 1.099C.366 1.832 0 2.714 0 3.746v12.487c0 1.032.366 1.914 1.099 2.647c.733.733 1.615 1.099 2.647 1.099H6.66c.19 0 .333-.007.429-.02a.504.504 0 0 0 .286-.169c.095-.1.143-.245.143-.435l-.007-.885c-.004-.564-.006-1.01-.006-1.34l-.3.052c-.19.035-.43.05-.721.046a5.555 5.555 0 0 1-.904-.091a2.026 2.026 0 0 1-.872-.39a1.651 1.651 0 0 1-.572-.8l-.13-.3a3.25 3.25 0 0 0-.41-.663c-.186-.243-.375-.407-.566-.494l-.09-.065a.956.956 0 0 1-.17-.156a.723.723 0 0 1-.117-.182c-.026-.061-.004-.111.065-.15c.07-.04.195-.059.378-.059l.26.04c.173.034.388.138.643.311a2.1 2.1 0 0 1 .631.677c.2.355.44.626.722.813c.282.186.566.28.852.28c.286 0 .533-.022.742-.065a2.59 2.59 0 0 0 .585-.196c.078-.58.29-1.028.637-1.34a8.907 8.907 0 0 1-1.333-.234a5.314 5.314 0 0 1-1.223-.507a3.5 3.5 0 0 1-1.047-.872c-.277-.347-.505-.802-.683-1.365c-.177-.564-.266-1.215-.266-1.952c0-1.049.342-1.942 1.027-2.68c-.32-.788-.29-1.673.091-2.652c.252-.079.625-.02 1.119.175c.494.195.856.362 1.086.5c.23.14.414.257.553.352a9.233 9.233 0 0 1 2.497-.338c.859 0 1.691.113 2.498.338l.494-.312a6.997 6.997 0 0 1 1.197-.572c.46-.174.81-.221 1.054-.143c.39.98.424 1.864.103 2.653c.685.737 1.028 1.63 1.028 2.68c0 .737-.089 1.39-.267 1.957c-.177.568-.407 1.023-.689 1.366a3.65 3.65 0 0 1-1.053.865c-.42.234-.828.403-1.223.507a8.9 8.9 0 0 1-1.333.235c.45.39.676 1.005.676 1.846v3.11c0 .147.021.266.065.357a.36.36 0 0 0 .208.189c.096.034.18.056.254.064c.074.01.18.013.318.013h2.914c1.032 0 1.914-.366 2.647-1.099c.732-.732 1.099-1.615 1.099-2.647V3.746c0-1.032-.367-1.914-1.1-2.647z"/>
        </svg>
    </a>




    <a target="_blank" class="social" title="Twitter" href="https://twitter.com/coffius">
        <svg xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" viewBox="0 0 16 16">
            <path fill="currentColor" d="M5.032 14.286c6.037 0 9.34-4.837 9.34-9.032c0-.137 0-.274-.01-.41A6.56 6.56 0 0 0 16 3.2c-.6.256-1.235.425-1.885.5a3.207 3.207 0 0 0 1.443-1.757c-.645.37-1.35.63-2.085.77a3.322 3.322 0 0 0-1.862-.958a3.384 3.384 0 0 0-2.082.334a3.223 3.223 0 0 0-1.442 1.49a3.08 3.08 0 0 0-.208 2.03a9.57 9.57 0 0 1-3.747-.963a9.269 9.269 0 0 1-3.018-2.354a3.086 3.086 0 0 0-.36 2.314c.189.787.68 1.475 1.376 1.924a3.344 3.344 0 0 1-1.49-.398v.04c0 .734.263 1.444.743 2.01a3.3 3.3 0 0 0 1.89 1.102c-.483.128-.99.146-1.482.055a3.19 3.19 0 0 0 1.168 1.577a3.36 3.36 0 0 0 1.9.627A6.732 6.732 0 0 1 0 12.86a9.527 9.527 0 0 0 5.032 1.423"/>
        </svg>
    </a>














        <p class="footnote">
powered by <a target="_blank" href="https://gohugo.io">Hugo</a> | themed with <a target="_blank" href="https://github.com/lukeorth/poison">poison</a>
    <br>
    &copy; 2023 coffius. All rights reserved.
</p>

  </div>
</aside>

            <main class="content container">
                <div class="post">
  <div class="info">
    <h1 class="post-title">
        <a href="http://coffius.github.io/posts/292173-validation-in-scala/">Validation in scala</a>
    </h1>
    
        <time datetime="2015-11-27T00:11:00&#43;0300" class="post-date">
            November 27, 2015
        </time>
    
    
    
    
    
    
    
</div>

  <p>This article is about possible solutions for validation in scala. Validation is the process of checking input data in order to provide its correctness and requirements compliance.</p>
<h1 id="implementations">Implementations</h1>
<p>There are several libraries in scala which can be used for validation:</p>
<ul>
<li><strong><a href="https://github.com/wix/accord" title="GitHub: Accord" target="_blank">Accord</a></strong> - Accord is a validation library written in and for Scala. <a href="http://wix.github.io/accord/" title="Accord: Docs" target="_blank">Docs here</a></li>
<li><strong>Skinny validator</strong> - skinny-validator is a portable library, so it is possible to use skinny-validator with Play2, Scalatra and any other web app frameworks. <a href="http://skinny-framework.org/documentation/validator.html" title="Skinny Validator: Docs" target="_blank">Docs here</a></li>
<li><strong><a href="https://github.com/tobnee/DValidation/" title="GitHub: DValidation" target="_blank">DValidation</a></strong> - A little, opinionated Scala domain object validation toolkit</li>
<li><strong><a href="https://github.com/davegurnell/validation" title="GitHub: io.underscore.validation" target="_blank">io.underscore.validation</a></strong> - Work-in-progress library demonstrating a functional programming approach to data validation in Scala</li>
</ul>
<p>The source code for this article is <strong><a href="https://github.com/coffius/koffio-validation" target="_blank">here</a></strong></p>
<h2 id="general">General</h2>
<p>Let&rsquo;s define domain classes which should be validated with the libraries above.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span><span style="color:#75715e">//Phone.scala
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//Phone.scala
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">package</span> io.koff.validation.domain
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * User phone
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">case</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Phone</span><span style="color:#f92672">(</span>value<span style="color:#66d9ef">:</span> <span style="color:#66d9ef">String</span><span style="color:#f92672">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span><span style="color:#75715e">//Address.scala
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">package</span> io.koff.validation.domain
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * User address
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @param street street
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @param house house number
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">case</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Address</span><span style="color:#f92672">(</span>street<span style="color:#66d9ef">:</span> <span style="color:#66d9ef">String</span><span style="color:#f92672">,</span> house<span style="color:#66d9ef">:</span> <span style="color:#66d9ef">Int</span><span style="color:#f92672">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span><span style="color:#75715e">//User.scala
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">package</span> io.koff.validation.domain
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * User - the main example domain class for validation
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @param login user login
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @param email user email
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @param password user password
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @param age user age
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @param phone user phone
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @param addresses list of user addresses - for showing a sequence validation
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @param userInfo recursive data for showing a recursive validation
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">case</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">User</span><span style="color:#f92672">(</span>login<span style="color:#66d9ef">:</span> <span style="color:#66d9ef">String</span><span style="color:#f92672">,</span>
</span></span><span style="display:flex;"><span>                email<span style="color:#66d9ef">:</span> <span style="color:#66d9ef">String</span><span style="color:#f92672">,</span>
</span></span><span style="display:flex;"><span>                password<span style="color:#66d9ef">:</span> <span style="color:#66d9ef">String</span><span style="color:#f92672">,</span>
</span></span><span style="display:flex;"><span>                age<span style="color:#66d9ef">:</span> <span style="color:#66d9ef">Int</span><span style="color:#f92672">,</span>
</span></span><span style="display:flex;"><span>                phone<span style="color:#66d9ef">:</span> <span style="color:#66d9ef">Option</span><span style="color:#f92672">[</span><span style="color:#66d9ef">Phone</span><span style="color:#f92672">],</span>
</span></span><span style="display:flex;"><span>                addresses<span style="color:#66d9ef">:</span> <span style="color:#66d9ef">Seq</span><span style="color:#f92672">[</span><span style="color:#66d9ef">Address</span><span style="color:#f92672">],</span>
</span></span><span style="display:flex;"><span>                userInfo<span style="color:#66d9ef">:</span> <span style="color:#66d9ef">InfoNode</span><span style="color:#f92672">[</span><span style="color:#66d9ef">String</span><span style="color:#f92672">]</span> <span style="color:#66d9ef">=</span> <span style="color:#a6e22e">InfoNode</span><span style="color:#f92672">.</span>default<span style="color:#f92672">)</span>
</span></span></code></pre></div><p>After we defined our domain we can implement validation rules for it using the listed libraries.</p>
<h2 id="accord">Accord</h2>
<p><strong>Accord</strong> is a standalone scala library which is developed and used in <a href="http://www.wix.com/" title="WiX site" target="_blank">WiX</a>.</p>
<p>The full example of using <strong>Accord</strong> can be found <a href="https://github.com/coffius/koffio-validation/blob/master/src/main/scala/io/koff/validation/AccordExample.scala" target="_blank">here</a></p>
<p>First what you need to do is to define validation rules using <code>validator(...)</code> method:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span><span style="color:#66d9ef">import</span> io.koff.validation.domain.<span style="color:#f92672">{</span><span style="color:#a6e22e">Address</span><span style="color:#f92672">,</span> <span style="color:#a6e22e">User</span><span style="color:#f92672">,</span> <span style="color:#a6e22e">Phone</span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> com.wix.accord._
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> dsl._
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * Define Accord validator for Address class
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">implicit</span> <span style="color:#66d9ef">val</span> addressValidator <span style="color:#66d9ef">=</span> validator<span style="color:#f92672">[</span><span style="color:#66d9ef">Address</span><span style="color:#f92672">]</span> <span style="color:#f92672">{</span> address <span style="color:#66d9ef">=&gt;</span>
</span></span><span style="display:flex;"><span>  address<span style="color:#f92672">.</span>street is notEmpty
</span></span><span style="display:flex;"><span>  address<span style="color:#f92672">.</span>house is <span style="color:#f92672">&gt;(</span><span style="color:#ae81ff">0</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * Define Accord validator for Phone class
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">implicit</span> <span style="color:#66d9ef">val</span> phoneValidator <span style="color:#66d9ef">=</span> validator<span style="color:#f92672">[</span><span style="color:#66d9ef">Phone</span><span style="color:#f92672">]{</span> phone <span style="color:#66d9ef">=&gt;</span>
</span></span><span style="display:flex;"><span>  phone<span style="color:#f92672">.</span>value is notEmpty and startWith<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;+7&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * Define Accord validator for User class
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">implicit</span> <span style="color:#66d9ef">val</span> userValidator <span style="color:#66d9ef">=</span> validator<span style="color:#f92672">[</span><span style="color:#66d9ef">User</span><span style="color:#f92672">]</span> <span style="color:#f92672">{</span> user <span style="color:#66d9ef">=&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//It is not possible to make a negative predicate
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//for example there is no way to forbid using &#34;admin&#34; in user name except for creation of your own validator
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  user<span style="color:#f92672">.</span>login is notEmpty and startWith<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;super_&#34;</span><span style="color:#f92672">)</span> and endWith<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;!&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//just as a sample :)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//don`t user regex to validate emails: 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">// - http://davidcel.is/posts/stop-validating-email-addresses-with-regex/
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//otherwise your users can face with problems using their emails on your service
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  user<span style="color:#f92672">.</span>email is matchRegex<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;&#34;&#34;\A([^@\s]+)@((?:[-a-z0-9]+\.)+[a-z]{2,})\z&#34;&#34;&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// all the definitions below are equal
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  user<span style="color:#f92672">.</span>password<span style="color:#f92672">.</span>length is between<span style="color:#f92672">(</span><span style="color:#ae81ff">6</span><span style="color:#f92672">,</span> <span style="color:#ae81ff">12</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  user<span style="color:#f92672">.</span>password have size <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">6</span>
</span></span><span style="display:flex;"><span>  user<span style="color:#f92672">.</span>password has size <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">12</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//you can validate number with range
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  user<span style="color:#f92672">.</span>age<span style="color:#f92672">.</span>must<span style="color:#f92672">(</span>between<span style="color:#f92672">(</span><span style="color:#ae81ff">13</span><span style="color:#f92672">,</span> <span style="color:#ae81ff">99</span><span style="color:#f92672">))</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//can use &gt;, &lt;, &gt;=, &lt;= etc
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  user<span style="color:#f92672">.</span>age must <span style="color:#f92672">&lt;=(</span><span style="color:#ae81ff">99</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  user<span style="color:#f92672">.</span>age must <span style="color:#f92672">&gt;=(</span><span style="color:#ae81ff">13</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//can`t write it like this
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//user.age must &gt;= 13
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//it will be a compilation error
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//check if a number field is equal or not equal to some value
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//user.age must equalTo(1000)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//user.age must notEqualTo(1)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//checks if an option field is defined with Some(value)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//user.phone is notEmpty
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//make sure that if the phone field is defined then it is defined with correct value
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  user<span style="color:#f92672">.</span>phone<span style="color:#f92672">.</span>each is valid
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  user<span style="color:#f92672">.</span>addresses should notEmpty
</span></span><span style="display:flex;"><span>  user<span style="color:#f92672">.</span>addresses<span style="color:#f92672">.</span>each is valid
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><p>Then you can check an object using <code>validate[T](...)</code> method. The validator for <code>T</code> must be accessed as an implicit value.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> main<span style="color:#f92672">(</span>args<span style="color:#66d9ef">:</span> <span style="color:#66d9ef">Array</span><span style="color:#f92672">[</span><span style="color:#66d9ef">String</span><span style="color:#f92672">])</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">val</span> correctUser <span style="color:#66d9ef">=</span> <span style="color:#a6e22e">User</span><span style="color:#f92672">(</span>
</span></span><span style="display:flex;"><span>    login <span style="color:#66d9ef">=</span> <span style="color:#e6db74">&#34;super_user_!&#34;</span><span style="color:#f92672">,</span>
</span></span><span style="display:flex;"><span>    email <span style="color:#66d9ef">=</span> <span style="color:#e6db74">&#34;example@example.com&#34;</span><span style="color:#f92672">,</span>
</span></span><span style="display:flex;"><span>    password <span style="color:#66d9ef">=</span> <span style="color:#e6db74">&#34;1234567&#34;</span><span style="color:#f92672">,</span>
</span></span><span style="display:flex;"><span>    age <span style="color:#66d9ef">=</span> <span style="color:#ae81ff">14</span><span style="color:#f92672">,</span>
</span></span><span style="display:flex;"><span>    phone <span style="color:#66d9ef">=</span> <span style="color:#a6e22e">Some</span><span style="color:#f92672">(</span><span style="color:#a6e22e">Phone</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;+78889993322&#34;</span><span style="color:#f92672">)),</span>
</span></span><span style="display:flex;"><span>    addresses <span style="color:#66d9ef">=</span> <span style="color:#a6e22e">Seq</span><span style="color:#f92672">(</span><span style="color:#a6e22e">Address</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Baker st.&#34;</span><span style="color:#f92672">,</span> <span style="color:#ae81ff">221</span><span style="color:#f92672">))</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  println<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;correct result: &#34;</span> <span style="color:#f92672">+</span> validate<span style="color:#f92672">(</span>correctUser<span style="color:#f92672">))</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//prints: &#39;correct result: Success&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">val</span> withWrongPhone <span style="color:#66d9ef">=</span> correctUser<span style="color:#f92672">.</span>copy<span style="color:#f92672">(</span>phone <span style="color:#66d9ef">=</span> <span style="color:#a6e22e">Some</span><span style="color:#f92672">(</span><span style="color:#a6e22e">Phone</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;8889993322&#34;</span><span style="color:#f92672">)))</span>
</span></span><span style="display:flex;"><span>  println<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;withWrongPhone: &#34;</span> <span style="color:#f92672">+</span> validate<span style="color:#f92672">(</span>withWrongPhone<span style="color:#f92672">))</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//prints: &#39;withWrongPhone: Failure(Set(GroupViolation(Phone(8889993322),is invalid,Some(phone),Set(RuleViolation(8889993322,must start with &#39;+7&#39;,Some(value))))))&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//More examples are in the code....
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#f92672">}</span>
</span></span></code></pre></div><p>In summary this library is quite good but there is one issue: an error message is represented as a sentence with a lexical description(<code>must start with '+7'</code>) instead of an error code like <code>User.phone.invalid</code>. It can be a problem when you want to localize error messages.</p>
<h2 id="skinny-validator">Skinny validator</h2>
<p>Skinny validator is a part of <strong><a href="http://skinny-framework.org/" title="Skinny Framework" target="_blank">Skinny Framework</a></strong> - a full-stack web app framework built on Skinny Micro.</p>
<p>The full example of using <strong>Skinny validator</strong> can be found <a href="https://github.com/coffius/koffio-validation/blob/master/src/main/scala/io/koff/validation/SkinnyExample.scala" target="_blank">here</a></p>
<p>At first let&rsquo;s define a new trait <code>EntityValidator</code> which helps organising validations rules for domain classes.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span><span style="color:#66d9ef">trait</span> <span style="color:#a6e22e">EntityValidator</span><span style="color:#f92672">[</span><span style="color:#66d9ef">T</span><span style="color:#f92672">]</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">def</span> getValidator<span style="color:#f92672">(</span>entity<span style="color:#66d9ef">:</span> <span style="color:#66d9ef">T</span><span style="color:#f92672">)</span><span style="color:#66d9ef">:</span> <span style="color:#66d9ef">Validator</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><p>And define the validator for User objects</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span><span style="color:#66d9ef">implicit</span> <span style="color:#66d9ef">val</span> userValidator <span style="color:#66d9ef">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">EntityValidator</span><span style="color:#f92672">[</span><span style="color:#66d9ef">User</span><span style="color:#f92672">]</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">override</span> <span style="color:#66d9ef">def</span> getValidator<span style="color:#f92672">(</span>entity<span style="color:#66d9ef">:</span> <span style="color:#66d9ef">User</span><span style="color:#f92672">)</span><span style="color:#66d9ef">:</span> <span style="color:#66d9ef">Validator</span> <span style="color:#f92672">=</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">import</span> skinny.validator.<span style="color:#f92672">{</span>email <span style="color:#66d9ef">=&gt;</span> correctEmail<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">import</span> entity._
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Validator</span><span style="color:#f92672">(</span>
</span></span><span style="display:flex;"><span>      param<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;login&#34;</span> <span style="color:#f92672">-&gt;</span> login<span style="color:#f92672">)</span> is notEmpty <span style="color:#f92672">&amp;</span> startWith<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;super_&#34;</span><span style="color:#f92672">)</span> <span style="color:#f92672">&amp;</span> endWith<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;!&#34;</span><span style="color:#f92672">),</span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">// skinny.validator.email using regex for checking email
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      param<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;email&#34;</span> <span style="color:#f92672">-&gt;</span> email<span style="color:#f92672">)</span> is correctEmail<span style="color:#f92672">,</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//these definitions are equal
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      param<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;password&#34;</span> <span style="color:#f92672">-&gt;</span> password<span style="color:#f92672">)</span> is minMaxLength<span style="color:#f92672">(</span><span style="color:#ae81ff">6</span><span style="color:#f92672">,</span> <span style="color:#ae81ff">12</span><span style="color:#f92672">),</span>
</span></span><span style="display:flex;"><span>      param<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;password&#34;</span> <span style="color:#f92672">-&gt;</span> password<span style="color:#f92672">)</span> is minLength<span style="color:#f92672">(</span><span style="color:#ae81ff">6</span><span style="color:#f92672">),</span>
</span></span><span style="display:flex;"><span>      param<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;password&#34;</span> <span style="color:#f92672">-&gt;</span> password<span style="color:#f92672">)</span> is maxLength<span style="color:#f92672">(</span><span style="color:#ae81ff">12</span><span style="color:#f92672">),</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//these definitions are equal
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      param<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;age&#34;</span> <span style="color:#f92672">-&gt;</span> age<span style="color:#f92672">)</span> is intMinMaxValue<span style="color:#f92672">(</span><span style="color:#ae81ff">13</span><span style="color:#f92672">,</span> <span style="color:#ae81ff">99</span><span style="color:#f92672">),</span>
</span></span><span style="display:flex;"><span>      param<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;age&#34;</span> <span style="color:#f92672">-&gt;</span> age<span style="color:#f92672">)</span> is intMinValue<span style="color:#f92672">(</span><span style="color:#ae81ff">13</span><span style="color:#f92672">),</span> <span style="color:#75715e">// &gt;=
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      param<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;age&#34;</span> <span style="color:#f92672">-&gt;</span> age<span style="color:#f92672">)</span> is intMaxValue<span style="color:#f92672">(</span><span style="color:#ae81ff">99</span><span style="color:#f92672">),</span> <span style="color:#75715e">// &lt;=
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#75715e">//this is how to check equation of values
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      param<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;age&#34;</span> <span style="color:#f92672">-&gt;</span> <span style="color:#f92672">(</span>age<span style="color:#f92672">,</span> <span style="color:#ae81ff">14</span><span style="color:#f92672">))</span> is same
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//there is no build-in way to check options(Some|None) and elements of collections
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><p>If we want to add new validation rule we should extend <code>ValidationRule</code> trait like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span><span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * For `startWith` we should create custom ValidationRule
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">case</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">startWith</span><span style="color:#f92672">(</span>value<span style="color:#66d9ef">:</span> <span style="color:#66d9ef">String</span><span style="color:#f92672">)</span> <span style="color:#66d9ef">extends</span> <span style="color:#a6e22e">ValidationRule</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">def</span> name <span style="color:#66d9ef">=</span> <span style="color:#e6db74">&#34;startWith&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">def</span> isValid<span style="color:#f92672">(</span>v<span style="color:#66d9ef">:</span> <span style="color:#66d9ef">Any</span><span style="color:#f92672">)</span> <span style="color:#66d9ef">=</span> <span style="color:#a6e22e">Option</span><span style="color:#f92672">(</span>v<span style="color:#f92672">)</span> <span style="color:#66d9ef">match</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">case</span> <span style="color:#a6e22e">Some</span><span style="color:#f92672">(</span>x<span style="color:#f92672">)</span> <span style="color:#66d9ef">=&gt;</span> x<span style="color:#f92672">.</span>toString<span style="color:#f92672">.</span>startsWith<span style="color:#f92672">(</span>value<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">case</span> <span style="color:#a6e22e">None</span> <span style="color:#66d9ef">=&gt;</span> <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * For `endWith` we should create custom ValidationRule
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">case</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">endWith</span><span style="color:#f92672">(</span>value<span style="color:#66d9ef">:</span> <span style="color:#66d9ef">String</span><span style="color:#f92672">)</span> <span style="color:#66d9ef">extends</span> <span style="color:#a6e22e">ValidationRule</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">def</span> name <span style="color:#66d9ef">=</span> <span style="color:#e6db74">&#34;endWith&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">def</span> isValid<span style="color:#f92672">(</span>v<span style="color:#66d9ef">:</span> <span style="color:#66d9ef">Any</span><span style="color:#f92672">)</span> <span style="color:#66d9ef">=</span> <span style="color:#a6e22e">Option</span><span style="color:#f92672">(</span>v<span style="color:#f92672">)</span> <span style="color:#66d9ef">match</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">case</span> <span style="color:#a6e22e">Some</span><span style="color:#f92672">(</span>x<span style="color:#f92672">)</span> <span style="color:#66d9ef">=&gt;</span> x<span style="color:#f92672">.</span>toString<span style="color:#f92672">.</span>endsWith<span style="color:#f92672">(</span>value<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">case</span> <span style="color:#a6e22e">None</span> <span style="color:#66d9ef">=&gt;</span> <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><p>Let&rsquo;s add utility method <code>validate[T](...)</code> in order to make easier using of skinny-validator.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> validate<span style="color:#f92672">[</span><span style="color:#66d9ef">T</span><span style="color:#f92672">](</span>entity<span style="color:#66d9ef">:</span> <span style="color:#66d9ef">T</span><span style="color:#f92672">)(</span><span style="color:#66d9ef">implicit</span> entityValidator<span style="color:#66d9ef">:</span> <span style="color:#66d9ef">EntityValidator</span><span style="color:#f92672">[</span><span style="color:#66d9ef">T</span><span style="color:#f92672">])</span><span style="color:#66d9ef">:</span> <span style="color:#66d9ef">Either</span><span style="color:#f92672">[</span><span style="color:#66d9ef">Errors</span>, <span style="color:#66d9ef">_</span><span style="color:#f92672">]</span> <span style="color:#66d9ef">=</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">val</span> validator <span style="color:#66d9ef">=</span> entityValidator<span style="color:#f92672">.</span>getValidator<span style="color:#f92672">(</span>entity<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">val</span> isOk <span style="color:#66d9ef">=</span> validator<span style="color:#f92672">.</span>validate<span style="color:#f92672">()</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span><span style="color:#f92672">(</span>isOk<span style="color:#f92672">){</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Right</span><span style="color:#f92672">(())</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Left</span><span style="color:#f92672">(</span>validator<span style="color:#f92672">.</span>errors<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> main<span style="color:#f92672">(</span>args<span style="color:#66d9ef">:</span> <span style="color:#66d9ef">Array</span><span style="color:#f92672">[</span><span style="color:#66d9ef">String</span><span style="color:#f92672">])</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">val</span> correctUser <span style="color:#66d9ef">=</span> <span style="color:#a6e22e">User</span><span style="color:#f92672">(</span>
</span></span><span style="display:flex;"><span>    login <span style="color:#66d9ef">=</span> <span style="color:#e6db74">&#34;super_user_!&#34;</span><span style="color:#f92672">,</span>
</span></span><span style="display:flex;"><span>    email <span style="color:#66d9ef">=</span> <span style="color:#e6db74">&#34;example@example.com&#34;</span><span style="color:#f92672">,</span>
</span></span><span style="display:flex;"><span>    password <span style="color:#66d9ef">=</span> <span style="color:#e6db74">&#34;1234567&#34;</span><span style="color:#f92672">,</span>
</span></span><span style="display:flex;"><span>    age <span style="color:#66d9ef">=</span> <span style="color:#ae81ff">14</span><span style="color:#f92672">,</span>
</span></span><span style="display:flex;"><span>    phone <span style="color:#66d9ef">=</span> <span style="color:#a6e22e">Some</span><span style="color:#f92672">(</span><span style="color:#a6e22e">Phone</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;+78889993322&#34;</span><span style="color:#f92672">)),</span>
</span></span><span style="display:flex;"><span>    addresses <span style="color:#66d9ef">=</span> <span style="color:#a6e22e">Seq</span><span style="color:#f92672">(</span><span style="color:#a6e22e">Address</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Baker st.&#34;</span><span style="color:#f92672">,</span> <span style="color:#ae81ff">221</span><span style="color:#f92672">))</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  println<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;correctUser: &#34;</span> <span style="color:#f92672">+</span> validate<span style="color:#f92672">(</span>correctUser<span style="color:#f92672">))</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//prints: &#39;correctUser: Right(())&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">val</span> allWrong <span style="color:#66d9ef">=</span> correctUser<span style="color:#f92672">.</span>copy<span style="color:#f92672">(</span>
</span></span><span style="display:flex;"><span>    login <span style="color:#66d9ef">=</span> <span style="color:#e6db74">&#34;not_super_user&#34;</span><span style="color:#f92672">,</span>
</span></span><span style="display:flex;"><span>    email <span style="color:#66d9ef">=</span> <span style="color:#e6db74">&#34;&#34;&#34;&#34;Look at all these spaces!&#34;@example.com&#34;&#34;&#34;</span><span style="color:#f92672">,</span> <span style="color:#75715e">//it is still a valid email address
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    password <span style="color:#66d9ef">=</span> <span style="color:#e6db74">&#34;short&#34;</span><span style="color:#f92672">,</span>
</span></span><span style="display:flex;"><span>    age <span style="color:#66d9ef">=</span> <span style="color:#ae81ff">101</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  println<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;correctUser: &#34;</span> <span style="color:#f92672">+</span> validate<span style="color:#f92672">(</span>allWrong<span style="color:#f92672">))</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//prints:
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//Left(
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//  Errors(
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//    Map(
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//      age -&gt; List(
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//        Error(name = intMinMaxValue, messageParams = List(13, 99)),
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//        Error(name = intMaxValue, messageParams = List(99)),
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//        Error(name = same, messageParams = List())
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//      ),
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//      password -&gt; List(
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//        Error(name = minMaxLength, messageParams = List(6, 12)),
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//        Error(name = minLength, messageParams = List(6))
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//      ),
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//      email -&gt; List(Error(name = email, messageParams = List())),
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//      login -&gt; List(Error(name = startWith, messageParams = List()))
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//    )
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//  )
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//)&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#f92672">}</span>
</span></span></code></pre></div><p>Skinny validator has a basic functionality for validation of simple objects. But if you want to validate more complex structures you have to write your own validation rules. It can be a problem to do it for sequences, options and other generic types.</p>
<h2 id="dvalidation">DValidation</h2>
<p>This library is a small validation toolkit on top of scalaz.</p>
<p>The full example of using <strong>DValidation</strong> can be found <a href="https://github.com/coffius/koffio-validation/blob/master/src/main/scala/io/koff/validation/DValidationExample.scala" target="_blank">here</a></p>
<p>In the first place we have to define instances of <code>DValidator[T]</code> for our domain classes. The important notice - it is necessary to import scalaz.Order[Int] for <code>isInRange</code> and other number checkers.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span><span style="color:#66d9ef">val</span> phoneValidator <span style="color:#66d9ef">=</span> <span style="color:#a6e22e">Validator</span><span style="color:#f92672">.</span>template<span style="color:#f92672">[</span><span style="color:#66d9ef">Phone</span><span style="color:#f92672">]</span> <span style="color:#f92672">{</span> phone <span style="color:#66d9ef">=&gt;</span>
</span></span><span style="display:flex;"><span>  phone<span style="color:#f92672">.</span>validateWith<span style="color:#f92672">(</span>
</span></span><span style="display:flex;"><span>    startWith<span style="color:#f92672">(</span>phone<span style="color:#f92672">.</span>value<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;+7&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">val</span> addressValidator <span style="color:#66d9ef">=</span> <span style="color:#a6e22e">Validator</span><span style="color:#f92672">.</span>template<span style="color:#f92672">[</span><span style="color:#66d9ef">Address</span><span style="color:#f92672">]</span> <span style="color:#f92672">{</span> address <span style="color:#66d9ef">=&gt;</span>
</span></span><span style="display:flex;"><span>  address<span style="color:#f92672">.</span>validateWith<span style="color:#f92672">(</span>
</span></span><span style="display:flex;"><span>    notBlank<span style="color:#f92672">(</span>address<span style="color:#f92672">.</span>street<span style="color:#f92672">)</span> forAttribute &#39;street<span style="color:#f92672">,</span>
</span></span><span style="display:flex;"><span>    address<span style="color:#f92672">.</span>house<span style="color:#f92672">.</span>is_&gt;<span style="color:#f92672">(</span><span style="color:#ae81ff">0</span><span style="color:#f92672">)</span> forAttribute &#39;house
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">val</span> userValidator <span style="color:#66d9ef">=</span> <span style="color:#a6e22e">Validator</span><span style="color:#f92672">.</span>template<span style="color:#f92672">[</span><span style="color:#66d9ef">User</span><span style="color:#f92672">]{</span> user <span style="color:#66d9ef">=&gt;</span>
</span></span><span style="display:flex;"><span>  user<span style="color:#f92672">.</span>validateWith<span style="color:#f92672">(</span>
</span></span><span style="display:flex;"><span>    notBlank<span style="color:#f92672">(</span>user<span style="color:#f92672">.</span>login<span style="color:#f92672">)</span> forAttribute &#39;login<span style="color:#f92672">,</span>
</span></span><span style="display:flex;"><span>    startWith<span style="color:#f92672">(</span>user<span style="color:#f92672">.</span>login<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;super_&#34;</span><span style="color:#f92672">)</span> forAttribute &#39;login<span style="color:#f92672">,</span>
</span></span><span style="display:flex;"><span>    ensure<span style="color:#f92672">(</span>user<span style="color:#f92672">.</span>login<span style="color:#f92672">)(</span><span style="color:#e6db74">&#34;error.dvalidation.end_with&#34;</span><span style="color:#f92672">)(</span><span style="color:#66d9ef">_</span><span style="color:#f92672">.</span>endsWith<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;!&#34;</span><span style="color:#f92672">))</span> forAttribute &#39;login<span style="color:#f92672">,</span>
</span></span><span style="display:flex;"><span>    regex<span style="color:#f92672">(</span>user<span style="color:#f92672">.</span>email<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;&#34;&#34;\A([^@\s]+)@((?:[-a-z0-9]+\.)+[a-z]{2,})\z&#34;&#34;&#34;</span><span style="color:#f92672">)</span> forAttribute &#39;email<span style="color:#f92672">,</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">//these definitions are equal
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    isInRange<span style="color:#f92672">(</span>user<span style="color:#f92672">.</span>password<span style="color:#f92672">.</span>length<span style="color:#f92672">,</span> <span style="color:#ae81ff">6</span><span style="color:#f92672">,</span> <span style="color:#ae81ff">12</span><span style="color:#f92672">)</span> forAttribute <span style="color:#a6e22e">Symbol</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;User.password.length.between&#34;</span><span style="color:#f92672">),</span>
</span></span><span style="display:flex;"><span>    user<span style="color:#f92672">.</span>password<span style="color:#f92672">.</span>length<span style="color:#f92672">.</span>is_&gt;=<span style="color:#f92672">(</span><span style="color:#ae81ff">6</span><span style="color:#f92672">)</span> forAttribute <span style="color:#a6e22e">Symbol</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;User.password.length.lessThan&#34;</span><span style="color:#f92672">),</span>
</span></span><span style="display:flex;"><span>    user<span style="color:#f92672">.</span>password<span style="color:#f92672">.</span>length<span style="color:#f92672">.</span>is_&lt;=<span style="color:#f92672">(</span><span style="color:#ae81ff">12</span><span style="color:#f92672">)</span> forAttribute <span style="color:#a6e22e">Symbol</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;User.password.length.greaterThan&#34;</span><span style="color:#f92672">),</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    user<span style="color:#f92672">.</span>age<span style="color:#f92672">.</span>is_&gt;=<span style="color:#f92672">(</span><span style="color:#ae81ff">13</span><span style="color:#f92672">)</span> forAttribute &#39;age<span style="color:#f92672">,</span>
</span></span><span style="display:flex;"><span>    user<span style="color:#f92672">.</span>age<span style="color:#f92672">.</span>is_&lt;=<span style="color:#f92672">(</span><span style="color:#ae81ff">99</span><span style="color:#f92672">)</span> forAttribute &#39;age<span style="color:#f92672">,</span>
</span></span><span style="display:flex;"><span>    user<span style="color:#f92672">.</span>age<span style="color:#f92672">.</span>is_==<span style="color:#f92672">(</span><span style="color:#ae81ff">14</span><span style="color:#f92672">)</span> forAttribute &#39;age<span style="color:#f92672">,</span> <span style="color:#75715e">// or you can use `is_===` for a strict check
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    validOpt<span style="color:#f92672">(</span>user<span style="color:#f92672">.</span>phone<span style="color:#f92672">)(</span>phoneValidator<span style="color:#f92672">),</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    hasElements<span style="color:#f92672">(</span>user<span style="color:#f92672">.</span>addresses<span style="color:#f92672">)</span> forAttribute &#39;addresses
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">).</span>withValidations<span style="color:#f92672">(</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// You also can user validSequence(...) to validate elements of a collection
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    validSequence<span style="color:#f92672">(</span>user<span style="color:#f92672">.</span>addresses<span style="color:#f92672">,</span> addressValidator<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><p>You can defile own error codes using <code>scala.Symbol</code> and <code>forAttribute(...)</code> method</p>
<p>Also we need additional validation rules like <code>startWith</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span><span style="color:#75715e">// We need to import scalaz.Order[Int] for `isInRange` and other number checkers
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">import</span> scalaz.std.AllInstances._
</span></span><span style="display:flex;"><span><span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * Example of a custom validator for DValidation
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @param toCheck value that should be checked
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @param startWith value that `toCheck` should start with
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> startWith<span style="color:#f92672">(</span>toCheck<span style="color:#66d9ef">:</span> <span style="color:#66d9ef">String</span><span style="color:#f92672">,</span> startWith<span style="color:#66d9ef">:</span> <span style="color:#66d9ef">String</span><span style="color:#f92672">)</span><span style="color:#66d9ef">:</span> <span style="color:#66d9ef">DValidation</span><span style="color:#f92672">[</span><span style="color:#66d9ef">String</span><span style="color:#f92672">]</span> <span style="color:#66d9ef">=</span>
</span></span><span style="display:flex;"><span>  ensure<span style="color:#f92672">(</span>toCheck<span style="color:#f92672">)(</span><span style="color:#e6db74">&#34;error.dvalidation.start_with&#34;</span><span style="color:#f92672">)(</span>a <span style="color:#66d9ef">=&gt;</span> a<span style="color:#f92672">.</span>startsWith<span style="color:#f92672">(</span>startWith<span style="color:#f92672">))</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * Simple regex checker
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> regex<span style="color:#f92672">(</span>toCheck<span style="color:#66d9ef">:</span> <span style="color:#66d9ef">String</span><span style="color:#f92672">,</span> regexStr<span style="color:#66d9ef">:</span> <span style="color:#66d9ef">String</span><span style="color:#f92672">)</span><span style="color:#66d9ef">:</span> <span style="color:#66d9ef">DValidation</span><span style="color:#f92672">[</span><span style="color:#66d9ef">String</span><span style="color:#f92672">]</span> <span style="color:#66d9ef">=</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">val</span> regex <span style="color:#66d9ef">=</span> regexStr<span style="color:#f92672">.</span>r
</span></span><span style="display:flex;"><span>  ensure<span style="color:#f92672">(</span>toCheck<span style="color:#f92672">)(</span><span style="color:#e6db74">&#34;error.dvalidation.regex&#34;</span><span style="color:#f92672">)(</span>a <span style="color:#66d9ef">=&gt;</span> regex<span style="color:#f92672">.</span>pattern<span style="color:#f92672">.</span>matcher<span style="color:#f92672">(</span>a<span style="color:#f92672">).</span>find<span style="color:#f92672">())</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><p>Correctness can be checked in this way:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> main<span style="color:#f92672">(</span>args<span style="color:#66d9ef">:</span> <span style="color:#66d9ef">Array</span><span style="color:#f92672">[</span><span style="color:#66d9ef">String</span><span style="color:#f92672">])</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">val</span> correctUser <span style="color:#66d9ef">=</span> <span style="color:#a6e22e">User</span><span style="color:#f92672">(</span>
</span></span><span style="display:flex;"><span>    login <span style="color:#66d9ef">=</span> <span style="color:#e6db74">&#34;super_user_!&#34;</span><span style="color:#f92672">,</span>
</span></span><span style="display:flex;"><span>    email <span style="color:#66d9ef">=</span> <span style="color:#e6db74">&#34;example@example.com&#34;</span><span style="color:#f92672">,</span>
</span></span><span style="display:flex;"><span>    password <span style="color:#66d9ef">=</span> <span style="color:#e6db74">&#34;1234567&#34;</span><span style="color:#f92672">,</span>
</span></span><span style="display:flex;"><span>    age <span style="color:#66d9ef">=</span> <span style="color:#ae81ff">14</span><span style="color:#f92672">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">//it will also work if phone = None
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    phone <span style="color:#66d9ef">=</span> <span style="color:#a6e22e">Some</span><span style="color:#f92672">(</span><span style="color:#a6e22e">Phone</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;+78889993322&#34;</span><span style="color:#f92672">)),</span>
</span></span><span style="display:flex;"><span>    addresses <span style="color:#66d9ef">=</span> <span style="color:#a6e22e">Seq</span><span style="color:#f92672">(</span><span style="color:#a6e22e">Address</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Baker st.&#34;</span><span style="color:#f92672">,</span> <span style="color:#ae81ff">221</span><span style="color:#f92672">))</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  println<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;correct result: &#34;</span> <span style="color:#f92672">+</span> userValidator<span style="color:#f92672">(</span>correctUser<span style="color:#f92672">))</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//prints: &#39;correct result:
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">// Success(
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//   User(
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//     super_user_!,
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//     example@example.com,
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//     1234567,
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//     14,
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//     Some(Phone(+78889993322)),
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//     List(Address(Baker st.,221)),
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//     InfoNode(1,None,List())
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//   )
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">// )
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">val</span> allWrong <span style="color:#66d9ef">=</span> correctUser<span style="color:#f92672">.</span>copy<span style="color:#f92672">(</span>
</span></span><span style="display:flex;"><span>    login <span style="color:#66d9ef">=</span> <span style="color:#e6db74">&#34;not_super_user&#34;</span><span style="color:#f92672">,</span>
</span></span><span style="display:flex;"><span>    email <span style="color:#66d9ef">=</span> <span style="color:#e6db74">&#34;&#34;&#34;&#34;Look at all these spaces!&#34;@example.com&#34;&#34;&#34;</span><span style="color:#f92672">,</span> <span style="color:#75715e">//it is still a valid email address
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    password <span style="color:#66d9ef">=</span> <span style="color:#e6db74">&#34;short&#34;</span><span style="color:#f92672">,</span>
</span></span><span style="display:flex;"><span>    age <span style="color:#66d9ef">=</span> <span style="color:#ae81ff">101</span><span style="color:#f92672">,</span>
</span></span><span style="display:flex;"><span>    phone <span style="color:#66d9ef">=</span> <span style="color:#a6e22e">Some</span><span style="color:#f92672">(</span><span style="color:#a6e22e">Phone</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;invalid_phone&#34;</span><span style="color:#f92672">))</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  println<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;allWrong: &#34;</span> <span style="color:#f92672">+</span> userValidator<span style="color:#f92672">(</span>allWrong<span style="color:#f92672">))</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//prints: &#39;allWrong:
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">// Failure(
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//   DomainError(path: /login, value: not_super_user, msgKey: error.dvalidation.start_with),
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//   DomainError(path: /login, value: not_super_user, msgKey: error.dvalidation.end_with),
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//   DomainError(path: /email, value: &#34;Look at all these spaces!&#34;@example.com, msgKey: error.dvalidation.regex),
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//   DomainError(path: /User.password.length.between, value: 5, msgKey: error.dvalidation.notGreaterThen, args: 6,false),
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//   DomainError(path: /User.password.length.lessThan, value: 5, msgKey: error.dvalidation.notGreaterThen, args: 6,true),
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//   DomainError(path: /age, value: 101, msgKey: error.dvalidation.notSmallerThen, args: 99,true),
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//   DomainError(path: /age, value: 14, msgKey: error.dvalidation.notEqual, args: 101),
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//   DomainError(path: /, value: invalid_phone, msgKey: error.dvalidation.start_with)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">// )
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#f92672">}</span>
</span></span></code></pre></div><p>Although there are not many build-in validators in DValidation, it can be considered as a good option for validation of complex structures if it is ok to have dependency on <code>scalaz</code> in your project.</p>
<h2 id="iounderscorevalidation">io.underscore.validation</h2>
<p>Despite that this library is named as &ldquo;Work-in-progress&rdquo; it has quite a good functionality and it is pretty simple in use.</p>
<p>The full example of using <strong>io.underscore.validation</strong> can be found <a href="https://github.com/coffius/koffio-validation/blob/master/src/main/scala/io/koff/validation/UnderscoreValidation.scala" target="_blank">here</a></p>
<p>You can define validators for our domain classes using <code>validate[T](...)</code> method and define custom validation methods like <code>startWith</code> and <code>endWith</code> extending <code>Validator[T]</code> trait</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span>  <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   * Define custom validators for io.underscore.validation
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">def</span> startWith<span style="color:#f92672">(</span>value<span style="color:#66d9ef">:</span> <span style="color:#f92672">=&gt;</span> <span style="color:#a6e22e">String</span><span style="color:#f92672">,</span> msg<span style="color:#66d9ef">:</span> <span style="color:#f92672">=&gt;</span> <span style="color:#a6e22e">String</span><span style="color:#f92672">)</span><span style="color:#66d9ef">:</span> <span style="color:#66d9ef">Validator</span><span style="color:#f92672">[</span><span style="color:#66d9ef">String</span><span style="color:#f92672">]</span> <span style="color:#66d9ef">=</span> <span style="color:#a6e22e">Validator</span><span style="color:#f92672">[</span><span style="color:#66d9ef">String</span><span style="color:#f92672">]</span> <span style="color:#f92672">{</span> in <span style="color:#66d9ef">=&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span><span style="color:#f92672">(</span>in<span style="color:#f92672">.</span>startsWith<span style="color:#f92672">(</span>value<span style="color:#f92672">))</span> pass <span style="color:#66d9ef">else</span> fail<span style="color:#f92672">(</span>msg<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">def</span> endWith<span style="color:#f92672">(</span>value<span style="color:#66d9ef">:</span> <span style="color:#f92672">=&gt;</span> <span style="color:#a6e22e">String</span><span style="color:#f92672">,</span> msg<span style="color:#66d9ef">:</span> <span style="color:#f92672">=&gt;</span> <span style="color:#a6e22e">String</span><span style="color:#f92672">)</span><span style="color:#66d9ef">:</span> <span style="color:#66d9ef">Validator</span><span style="color:#f92672">[</span><span style="color:#66d9ef">String</span><span style="color:#f92672">]</span> <span style="color:#66d9ef">=</span> <span style="color:#a6e22e">Validator</span><span style="color:#f92672">[</span><span style="color:#66d9ef">String</span><span style="color:#f92672">]</span> <span style="color:#f92672">{</span> in <span style="color:#66d9ef">=&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span><span style="color:#f92672">(</span>in<span style="color:#f92672">.</span>endsWith<span style="color:#f92672">(</span>value<span style="color:#f92672">))</span> pass <span style="color:#66d9ef">else</span> fail<span style="color:#f92672">(</span>msg<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//  implicit val infoNodeValidator = validate[InfoNode]
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//    .field(_.index)(gte(1, &#34;InfoNode.index.gte&#34;))
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">implicit</span> <span style="color:#66d9ef">val</span> phoneValidator <span style="color:#66d9ef">=</span> validate<span style="color:#f92672">[</span><span style="color:#66d9ef">Phone</span><span style="color:#f92672">].</span>field<span style="color:#f92672">(</span><span style="color:#66d9ef">_</span><span style="color:#f92672">.</span>value<span style="color:#f92672">)(</span>startWith<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;+7&#34;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;Phone.value.startWith&#34;</span><span style="color:#f92672">))</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">implicit</span> <span style="color:#66d9ef">val</span> addressValidator <span style="color:#66d9ef">=</span> validate<span style="color:#f92672">[</span><span style="color:#66d9ef">Address</span><span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">.</span>field<span style="color:#f92672">(</span><span style="color:#66d9ef">_</span><span style="color:#f92672">.</span>street<span style="color:#f92672">)(</span>nonEmpty<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Address.street.notEmpty&#34;</span><span style="color:#f92672">))</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">.</span>field<span style="color:#f92672">(</span><span style="color:#66d9ef">_</span><span style="color:#f92672">.</span>house<span style="color:#f92672">)(</span>gt<span style="color:#f92672">(</span><span style="color:#ae81ff">0</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;Address.house.gt&#34;</span><span style="color:#f92672">))</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">implicit</span> <span style="color:#66d9ef">val</span> userValidator <span style="color:#66d9ef">=</span> validate<span style="color:#f92672">[</span><span style="color:#66d9ef">User</span><span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">.</span>field<span style="color:#f92672">(</span><span style="color:#66d9ef">_</span><span style="color:#f92672">.</span>login<span style="color:#f92672">)(</span>nonEmpty  <span style="color:#f92672">(</span><span style="color:#e6db74">&#34;User.login.notEmpty&#34;</span><span style="color:#f92672">))</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">.</span>field<span style="color:#f92672">(</span><span style="color:#66d9ef">_</span><span style="color:#f92672">.</span>login<span style="color:#f92672">)(</span>startWith <span style="color:#f92672">(</span><span style="color:#e6db74">&#34;super_&#34;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;User.login.startWith&#34;</span><span style="color:#f92672">)</span> and endWith<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;!&#34;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;User.login.endWith&#34;</span><span style="color:#f92672">))</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">.</span>field<span style="color:#f92672">(</span><span style="color:#66d9ef">_</span><span style="color:#f92672">.</span>email<span style="color:#f92672">)(</span>matchesRegex<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;&#34;&#34;\A([^@\s]+)@((?:[-a-z0-9]+\.)+[a-z]{2,})\z&#34;&#34;&#34;</span><span style="color:#f92672">.</span>r<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;User.login.invalid&#34;</span><span style="color:#f92672">))</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">.</span>field<span style="color:#f92672">(</span><span style="color:#66d9ef">_</span><span style="color:#f92672">.</span>password<span style="color:#f92672">)(</span>lengthGt   <span style="color:#f92672">(</span><span style="color:#ae81ff">6</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;User.password.lengthGt&#34;</span><span style="color:#f92672">))</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">.</span>field<span style="color:#f92672">(</span><span style="color:#66d9ef">_</span><span style="color:#f92672">.</span>password<span style="color:#f92672">)(</span>lengthLte  <span style="color:#f92672">(</span><span style="color:#ae81ff">12</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;User.password.lengthLte&#34;</span><span style="color:#f92672">))</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">.</span>field<span style="color:#f92672">(</span><span style="color:#66d9ef">_</span><span style="color:#f92672">.</span>age<span style="color:#f92672">)(</span>gte<span style="color:#f92672">(</span><span style="color:#ae81ff">13</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;User.age.gte&#34;</span><span style="color:#f92672">))</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">.</span>field<span style="color:#f92672">(</span><span style="color:#66d9ef">_</span><span style="color:#f92672">.</span>age<span style="color:#f92672">)(</span>lte<span style="color:#f92672">(</span><span style="color:#ae81ff">99</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;User.age.lte&#34;</span><span style="color:#f92672">))</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">.</span>field<span style="color:#f92672">(</span><span style="color:#66d9ef">_</span><span style="color:#f92672">.</span>age<span style="color:#f92672">)(</span>eql<span style="color:#f92672">(</span><span style="color:#ae81ff">14</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;User.age.eql&#34;</span><span style="color:#f92672">))</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">.</span>field<span style="color:#f92672">(</span><span style="color:#66d9ef">_</span><span style="color:#f92672">.</span>phone<span style="color:#f92672">)(</span>optional<span style="color:#f92672">(</span>phoneValidator<span style="color:#f92672">))</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// also you can use `required(...)` if you want to have a defined optional field
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//.field(_.phone)(required(phoneValidator))
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//and `.seqField(...)` for validate Seq[T]
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#f92672">.</span>field<span style="color:#f92672">(</span><span style="color:#66d9ef">_</span><span style="color:#f92672">.</span>addresses<span style="color:#f92672">)(</span>nonEmpty<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;User.address.notEmpty&#34;</span><span style="color:#f92672">))</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">.</span>field<span style="color:#f92672">(</span><span style="color:#66d9ef">_</span><span style="color:#f92672">.</span>userInfo<span style="color:#f92672">)(</span>infoNode<span style="color:#f92672">(</span>nonEmpty<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;User.userInfo.value.notEmpty&#34;</span><span style="color:#f92672">)))</span>              <span style="color:#75715e">//using recursion
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#f92672">.</span>field<span style="color:#f92672">(</span><span style="color:#66d9ef">_</span><span style="color:#f92672">.</span>userInfo<span style="color:#f92672">)(</span>infoNode<span style="color:#f92672">(</span>startWith<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;correct_&#34;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;User.userInfo.value.startWith&#34;</span><span style="color:#f92672">)))</span><span style="color:#75715e">//using recursion
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#f92672">.</span>seqField<span style="color:#f92672">(</span><span style="color:#66d9ef">_</span><span style="color:#f92672">.</span>addresses<span style="color:#f92672">)</span>
</span></span></code></pre></div><p>Lines <code>//using recursion</code> will be discussed in the next section.</p>
<p>Object validation can be done by using implicit method <code>validate</code> in <code>io.underscore.validation</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> main<span style="color:#f92672">(</span>args<span style="color:#66d9ef">:</span> <span style="color:#66d9ef">Array</span><span style="color:#f92672">[</span><span style="color:#66d9ef">String</span><span style="color:#f92672">])</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">val</span> correctUser <span style="color:#66d9ef">=</span> <span style="color:#a6e22e">User</span><span style="color:#f92672">(</span>
</span></span><span style="display:flex;"><span>    login <span style="color:#66d9ef">=</span> <span style="color:#e6db74">&#34;super_user_!&#34;</span><span style="color:#f92672">,</span>
</span></span><span style="display:flex;"><span>    email <span style="color:#66d9ef">=</span> <span style="color:#e6db74">&#34;example@example.com&#34;</span><span style="color:#f92672">,</span>
</span></span><span style="display:flex;"><span>    password <span style="color:#66d9ef">=</span> <span style="color:#e6db74">&#34;1234567&#34;</span><span style="color:#f92672">,</span>
</span></span><span style="display:flex;"><span>    age <span style="color:#66d9ef">=</span> <span style="color:#ae81ff">14</span><span style="color:#f92672">,</span>
</span></span><span style="display:flex;"><span>    phone <span style="color:#66d9ef">=</span> <span style="color:#a6e22e">Some</span><span style="color:#f92672">(</span><span style="color:#a6e22e">Phone</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;+78889993322&#34;</span><span style="color:#f92672">)),</span>
</span></span><span style="display:flex;"><span>    addresses <span style="color:#66d9ef">=</span> <span style="color:#a6e22e">Seq</span><span style="color:#f92672">(</span><span style="color:#a6e22e">Address</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Baker st.&#34;</span><span style="color:#f92672">,</span> <span style="color:#ae81ff">221</span><span style="color:#f92672">)),</span>
</span></span><span style="display:flex;"><span>    userInfo <span style="color:#66d9ef">=</span> <span style="color:#a6e22e">InfoNode</span><span style="color:#f92672">(</span>
</span></span><span style="display:flex;"><span>      index <span style="color:#66d9ef">=</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">,</span>
</span></span><span style="display:flex;"><span>      value <span style="color:#66d9ef">=</span> <span style="color:#a6e22e">Some</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;correct_parent&#34;</span><span style="color:#f92672">),</span>
</span></span><span style="display:flex;"><span>      children <span style="color:#66d9ef">=</span> <span style="color:#a6e22e">Seq</span><span style="color:#f92672">(</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">InfoNode</span><span style="color:#f92672">(</span><span style="color:#ae81ff">10</span><span style="color:#f92672">,</span> <span style="color:#a6e22e">Some</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;correct_child&#34;</span><span style="color:#f92672">),</span> <span style="color:#a6e22e">Seq</span><span style="color:#f92672">.</span>empty<span style="color:#f92672">),</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">InfoNode</span><span style="color:#f92672">(</span><span style="color:#ae81ff">20</span><span style="color:#f92672">,</span> <span style="color:#a6e22e">None</span><span style="color:#f92672">,</span> <span style="color:#a6e22e">Seq</span><span style="color:#f92672">.</span>empty<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  println<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;correctUser: &#34;</span> <span style="color:#f92672">+</span> correctUser<span style="color:#f92672">.</span>validate<span style="color:#f92672">.</span>errors<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// prints: &#39;correctUser: List()&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">val</span> allWrong <span style="color:#66d9ef">=</span> correctUser<span style="color:#f92672">.</span>copy<span style="color:#f92672">(</span>
</span></span><span style="display:flex;"><span>    login <span style="color:#66d9ef">=</span> <span style="color:#e6db74">&#34;not_super_user&#34;</span><span style="color:#f92672">,</span>
</span></span><span style="display:flex;"><span>    email <span style="color:#66d9ef">=</span> <span style="color:#e6db74">&#34;&#34;&#34;&#34;Look at all these spaces!&#34;@example.com&#34;&#34;&#34;</span><span style="color:#f92672">,</span> <span style="color:#75715e">//it is still a valid email address
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    password <span style="color:#66d9ef">=</span> <span style="color:#e6db74">&#34;short&#34;</span><span style="color:#f92672">,</span>
</span></span><span style="display:flex;"><span>    age <span style="color:#66d9ef">=</span> <span style="color:#ae81ff">101</span><span style="color:#f92672">,</span>
</span></span><span style="display:flex;"><span>    addresses <span style="color:#66d9ef">=</span> <span style="color:#a6e22e">Seq</span><span style="color:#f92672">(</span><span style="color:#a6e22e">Address</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">,</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span><span style="color:#f92672">))</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  println<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;allWrong: &#34;</span> <span style="color:#f92672">+</span> allWrong<span style="color:#f92672">.</span>validate<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//prints: &#39;allWrong:
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">// Validated(
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//    User(
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//      not_super_user,
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//      &#34;Look at all these spaces!&#34;@example.com,
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//      short,
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//      101,
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//      Some(Phone(+78889993322)),
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//      List(Address(,-1)),
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//      InfoNode(/* doesn&#39;t right now */),
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//    List(
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//      ValidationError(User.login.startWith,ValidationPath(login)),
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//      ValidationError(User.login.endWith,ValidationPath(login)),
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//      ValidationError(User.login.invalid,ValidationPath(email)),
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//      ValidationError(User.password.lengthGt,ValidationPath(password)),
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//      ValidationError(User.age.lte,ValidationPath(age)),
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//      ValidationError(User.age.eql,ValidationPath(age)),
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//      ValidationError(Address.street.notEmpty,ValidationPath(addresses[0].street)),
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//      ValidationError(Address.house.gt,ValidationPath(addresses[0].house))
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//    )
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">// )
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#f92672">}</span>
</span></span></code></pre></div><p>So davegurnell/validation can be considered as a great lib for validation of very complex structures like generics and recursions if you are not bothered concerning dependence on <code>scala.language.experimental.macros</code> and <code>scala.language.higherKinds</code> which are used in this lib.</p>
<h2 id="bonus-recursive-validation">Bonus: Recursive validation</h2>
<p>And here is a little bonus - validation of recursive structures. Recursive validation was implemented for <code>io.underscore.validation</code> but I think it can be easily ported at least to <code>DValidation</code>.
In our domains classes we have this generic recursive structure:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span><span style="color:#75715e">//InfoNode.scala
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">package</span> io.koff.validation.domain
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * Generic recursive example of domain class
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @param index here it is just a number without additional meaning
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @param value some value which we want to store in a node and validate
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @param children child nodes which should also be validated
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @tparam T value type
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">case</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">InfoNode</span><span style="color:#f92672">[</span><span style="color:#66d9ef">T</span><span style="color:#f92672">](</span>index<span style="color:#66d9ef">:</span> <span style="color:#66d9ef">Int</span><span style="color:#f92672">,</span> value<span style="color:#66d9ef">:</span> <span style="color:#66d9ef">Option</span><span style="color:#f92672">[</span><span style="color:#66d9ef">T</span><span style="color:#f92672">],</span> children<span style="color:#66d9ef">:</span> <span style="color:#66d9ef">Seq</span><span style="color:#f92672">[</span><span style="color:#66d9ef">InfoNode</span><span style="color:#f92672">[</span><span style="color:#66d9ef">T</span><span style="color:#f92672">]])</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">object</span> <span style="color:#a6e22e">InfoNode</span><span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   * Just a default value for InfoNode
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">def</span> default<span style="color:#f92672">[</span><span style="color:#66d9ef">T</span><span style="color:#f92672">]</span><span style="color:#66d9ef">:</span> <span style="color:#66d9ef">InfoNode</span><span style="color:#f92672">[</span><span style="color:#66d9ef">T</span><span style="color:#f92672">]</span> <span style="color:#66d9ef">=</span> <span style="color:#a6e22e">InfoNode</span><span style="color:#f92672">(</span><span style="color:#ae81ff">1</span><span style="color:#f92672">,</span> <span style="color:#a6e22e">None</span><span style="color:#f92672">,</span> <span style="color:#a6e22e">Seq</span><span style="color:#f92672">.</span>empty<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><p>In order to validate it <code>infoNode[T](rule: Validator[T])</code> method has been created:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span>  <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   * Recursive validator for InfoNode
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">def</span> infoNode<span style="color:#f92672">[</span><span style="color:#66d9ef">T</span><span style="color:#f92672">](</span>rule<span style="color:#66d9ef">:</span> <span style="color:#66d9ef">Validator</span><span style="color:#f92672">[</span><span style="color:#66d9ef">T</span><span style="color:#f92672">])</span><span style="color:#66d9ef">:</span> <span style="color:#66d9ef">Validator</span><span style="color:#f92672">[</span><span style="color:#66d9ef">InfoNode</span><span style="color:#f92672">[</span><span style="color:#66d9ef">T</span><span style="color:#f92672">]]</span> <span style="color:#66d9ef">=</span> <span style="color:#a6e22e">Validator</span><span style="color:#f92672">[</span><span style="color:#66d9ef">InfoNode</span><span style="color:#f92672">[</span><span style="color:#66d9ef">T</span><span style="color:#f92672">]]</span> <span style="color:#f92672">{</span> in <span style="color:#66d9ef">=&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> generalValidator <span style="color:#66d9ef">=</span> validate<span style="color:#f92672">[</span><span style="color:#66d9ef">InfoNode</span><span style="color:#f92672">[</span><span style="color:#66d9ef">T</span><span style="color:#f92672">]]</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">.</span>field<span style="color:#f92672">(</span><span style="color:#66d9ef">_</span><span style="color:#f92672">.</span>index<span style="color:#f92672">)(</span>gte<span style="color:#f92672">(</span><span style="color:#ae81ff">1</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;InfoNode.index.gte&#34;</span><span style="color:#f92672">))</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">.</span>field<span style="color:#f92672">(</span><span style="color:#66d9ef">_</span><span style="color:#f92672">.</span>children<span style="color:#f92672">)(</span>lengthLte<span style="color:#f92672">(</span><span style="color:#ae81ff">2</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;InfoNode.children.lengthLte&#34;</span><span style="color:#f92672">))</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">.</span>field<span style="color:#f92672">(</span><span style="color:#66d9ef">_</span><span style="color:#f92672">.</span>value<span style="color:#f92672">)(</span>optional<span style="color:#f92672">(</span>rule<span style="color:#f92672">))</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> resultValidator <span style="color:#66d9ef">=</span> <span style="color:#66d9ef">if</span><span style="color:#f92672">(</span>in<span style="color:#f92672">.</span>children<span style="color:#f92672">.</span>isEmpty<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>      generalValidator
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>      generalValidator<span style="color:#f92672">.</span>seqField<span style="color:#f92672">(</span><span style="color:#66d9ef">_</span><span style="color:#f92672">.</span>children<span style="color:#f92672">)(</span>infoNode<span style="color:#f92672">(</span>rule<span style="color:#f92672">))</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    resultValidator<span style="color:#f92672">(</span>in<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">}</span>
</span></span></code></pre></div><p>As the argument this method receives a validation rule for <code>T</code> type - <code>Validator[T]</code>. So you can use other rules or validators in order to check all children in this recursive structure:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span><span style="color:#f92672">.</span>field<span style="color:#f92672">(</span><span style="color:#66d9ef">_</span><span style="color:#f92672">.</span>userInfo<span style="color:#f92672">)(</span>infoNode<span style="color:#f92672">(</span>nonEmpty<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;User.userInfo.value.notEmpty&#34;</span><span style="color:#f92672">)))</span>               <span style="color:#75715e">//using recursion
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#f92672">.</span>field<span style="color:#f92672">(</span><span style="color:#66d9ef">_</span><span style="color:#f92672">.</span>userInfo<span style="color:#f92672">)(</span>infoNode<span style="color:#f92672">(</span>startWith<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;correct_&#34;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;User.userInfo.value.startWith&#34;</span><span style="color:#f92672">)))</span> <span style="color:#75715e">//using recursion
</span></span></span></code></pre></div><h2 id="links">Links</h2>
<ul>
<li><strong><a href="https://github.com/coffius/koffio-validation" target="_blank">Article Examples</a></strong></li>
<li><strong><a href="https://github.com/wix/accord" title="GitHub: Accord" target="_blank">Accord</a></strong></li>
<li><strong><a href="http://skinny-framework.org/documentation/validator.html" title="Skinny Validator: Docs" target="_blank">Skinny validator</a></strong></li>
<li><strong><a href="https://github.com/tobnee/DValidation/" title="GitHub: DValidation" target="_blank">DValidation</a></strong></li>
<li><strong><a href="https://github.com/davegurnell/validation" title="GitHub: io.underscore.validation" target="_blank">io.underscore.validation</a></strong></li>
</ul>
  <hr>
<div class="footer">
    
	    
            <a class="previous-post" href="http://coffius.github.io/posts/using-t-digest/?ref=footer"><span style="font-weight:bold;">« Previous</span><br>Using T-Digest: Median calculation and anomaly...</a>
        
	    
            <div class="next-post">
                <a href="http://coffius.github.io/posts/pagination-and-streams/?ref=footer"><span style="font-weight:bold;">Next »</span><br>Pagination and Streams</a>
            </div>
        
    
</div>

  
    <div class="comments">
    
        <div id="disqus_thread"></div>
<script type="application/javascript">
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "koff-io" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    
</div>

  
</div>
            </main>
            
  
    <div class="article-toc ">
    <div class="toc-wrapper">
      <h4 id="contents"></h4>
      <nav id="TableOfContents">
  <ul>
    <li><a href="#general">General</a></li>
    <li><a href="#accord">Accord</a></li>
    <li><a href="#skinny-validator">Skinny validator</a></li>
    <li><a href="#dvalidation">DValidation</a></li>
    <li><a href="#iounderscorevalidation">io.underscore.validation</a></li>
    <li><a href="#bonus-recursive-validation">Bonus: Recursive validation</a></li>
    <li><a href="#links">Links</a></li>
  </ul>
</nav>
    </div>
</div>

  

        </div>
    </body>
</html>
